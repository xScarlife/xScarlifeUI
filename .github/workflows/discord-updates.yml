name: Repository Updates

on:
  push:
    branches:
      - main

jobs:
  notify:
    runs-on: ubuntu-22.04
    steps:
      - name: Notify Discord
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
          COMMIT_MSG: ${{ github.event.head_commit.message }}
          COMMIT_URL: https://github.com/${{ github.repository }}/commit/${{ github.sha }}
        run: |
          curl -X POST -H "Content-Type: application/json" \
          -d '{
            "username": "xScarlifeUI Updates",
            "avatar_url": "https://i.imgur.com/IFQ4Lvc.png",
            "embeds": [
              {
                "title": "xScarlifeUI update pushed",
                "url": "'"$COMMIT_URL"'",
                "description": "**Commit:** '"$COMMIT_MSG"'\n\nðŸ‘‰ **Grab the latest import strings here:**\nhttps://xscarlife-gaming.com/xscarlifeui-import-strings/",
                "color": 16753920,
                "footer": {
                  "text": "xScarlife Gaming"
                }
              }
            ]
          }' \
          "$DISCORD_WEBHOOK"
